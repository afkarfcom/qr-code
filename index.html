<!DOCTYPE html>
<html>
<head>
    <title>Generator Kode QR</title>
    <style>
        /* CSS yang Diperbarui */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; /* Font yang lebih modern */
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            flex-direction: column;
            background-color: #ffffff; /* Latar belakang sedikit keabu-abuan */
            margin: 0;
        }
        .container {
            background-color: white;
            padding: 40px; /* Padding lebih besar */
            border-radius: 15px; /* Sudut lebih bulat */
            box-shadow: 0 10px 25px rgba(0,0,0,0.08); /* Bayangan lebih lembut */
            text-align: center;
            width: 90%;
            max-width: 400px; /* Lebar maksimum untuk container */
            transition: all 0.3s ease;
        }
        .container:hover {
            box-shadow: 0 15px 35px rgba(0,0,0,0.12); /* Efek bayangan saat di-hover */
        }
        h2 {
            margin-top: 0;
            color: #333;
        }
        #qrcode {
            width: 256px;
            height: 256px;
            margin: 25px auto;
            border: 2px solid #000; /* Menambahkan border hitam */
            padding: 10px; /* Memberi sedikit ruang di dalam */
            background: #ffffff; /* Latar belakang hitam untuk QR code terbalik */
            border-radius: 10px; /* Sudut bulat untuk area QR code */
            display: flex; /* Menggunakan flexbox untuk memusatkan canvas */
            justify-content: center;
            align-items: center;
        }
        #qrcode canvas {
             /* Pastikan canvas tidak melebihi padding parent */
            max-width: 100%;
            height: auto;
        }
        input[type="text"] {
            width: calc(100% - 24px); /* Kalkulasi lebar agar pas */
            padding: 12px;
            margin-bottom: 20px; /* Jarak lebih besar */
            border: 1px solid #ddd;
            border-radius: 8px; /* Sudut lebih bulat */
            font-size: 16px;
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
        }
        input[type="text"]:focus {
            outline: none;
            border-color: #007bff;
            box-shadow: 0 0 8px rgba(0, 123, 255, 0.2); /* Efek glow saat input aktif */
        }
        button {
            padding: 12px 25px;
            margin-top: 10px;
            border: none;
            border-radius: 8px;
            background-color: #007bff;
            color: white;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600; /* Teks tombol lebih tebal */
            transition: background-color 0.3s ease, transform 0.2s ease; /* Transisi halus */
            display: inline-block; /* Agar transform bekerja */
        }
        button:hover {
            background-color: #0056b3;
            transform: translateY(-2px); /* Efek sedikit terangkat saat di-hover */
        }
        button:active {
            transform: translateY(0); /* Kembali ke posisi semula saat diklik */
        }
        #download-button {
            background-color: #28a745;
        }
        #download-button:hover {
            background-color: #218838;
        }
    </style>
</head>
<body>

    <div class="container">
        <h2>Generator Kode QR</h2>
        <input type="text" id="text-input" placeholder="Masukkan teks atau URL di sini">
        <br>
        <button id="generate-button">Hasilkan Kode QR</button>

        <div id="qrcode"></div>

        <button id="download-button" style="display: none;">Unduh sebagai JPG</button>
    </div>

    <script src="https://cdn.rawgit.com/davidshimjs/qrcodejs/gh-pages/qrcode.min.js"></script>
    <script>
        // Membuat objek QRCode dengan pengaturan warna yang DIBALIK
        var qrcode = new QRCode(document.getElementById("qrcode"), {
            width : 256,
            height : 256,
            colorDark : "#ffffff", // Warna kode QR menjadi PUTIH
            colorLight : "#000000", // Warna latar belakang menjadi HITAM
            correctLevel : QRCode.CorrectLevel.H
        });

        function generateQrCode() {
            var text = document.getElementById("text-input").value;
            var qrCodeContainer = document.getElementById("qrcode");
            
            // Mengosongkan kontainer sebelum menghasilkan kode baru
            qrCodeContainer.innerHTML = ''; 
            
            if (text) {
                // Membuat ulang objek untuk menghindari masalah pada generasi kedua, dst.
                qrcode = new QRCode(qrCodeContainer, {
                    text: text,
                    width : 256,
                    height : 256,
                    colorDark : "#ffffff",
                    colorLight : "#000000",
                    correctLevel : QRCode.CorrectLevel.H
                });
                
                document.getElementById("download-button").style.display = "inline-block";
            } else {
                alert("Silakan masukkan teks atau URL");
            }
        }

        // Event listener untuk tombol "Hasilkan"
        document.getElementById("generate-button").addEventListener("click", function(){
            generateQrCode();
        });

        // Event listener untuk tombol "Unduh"
        document.getElementById("download-button").addEventListener("click", function(){
            var originalCanvas = document.querySelector("#qrcode canvas");
            
            if (!originalCanvas) {
                alert("Silakan hasilkan Kode QR terlebih dahulu.");
                return;
            }
            
            // Membuat canvas baru dengan ukuran 500x500
            var downloadCanvas = document.createElement('canvas');
            downloadCanvas.width = 500;
            downloadCanvas.height = 500;
            var ctx = downloadCanvas.getContext('2d');

            var borderSize = 15; // Atur ketebalan border sesuai keinginan

            // 1. Isi seluruh canvas unduhan dengan warna hitam, yang akan berfungsi sebagai border.
            ctx.fillStyle = '#000';
            ctx.fillRect(0, 0, downloadCanvas.width, downloadCanvas.height);
            
            // 2. Gambar kode QR asli di atasnya, tetapi lebih kecil, sehingga menyisakan border hitam di sekelilingnya.
            // Posisi gambar (x, y) adalah (borderSize, borderSize)
            // Ukuran gambar adalah total lebar/tinggi dikurangi dua kali ukuran border
            ctx.drawImage(originalCanvas, borderSize, borderSize, downloadCanvas.width - (borderSize * 2), downloadCanvas.height - (borderSize * 2));

            // Mengubah canvas menjadi data URL format JPG
            var image = downloadCanvas.toDataURL("image/jpeg", 1.0);
            
            var link = document.createElement('a');
            link.download = 'Code-qr.jpg'; // Mengatur nama file
            link.href = image;
            link.click();
        });
    </script>

</body>
</html>
